<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://unpkg.com; style-src 'self' 'unsafe-inline' https://unpkg.com; img-src 'self' data: https:; connect-src 'self';">
    <title>War Room 1776 - Episode 0.1: Winter Ambush</title>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css" />
</head>
<body>
    <!-- Full-Screen Map Container -->
    <div id="map-viewport">
        <div id="map"></div>
    </div>

    <!-- Floating HUD: Atlas Panel (Top-Left) - Contextual -->
    <div id="floating-atlas" class="hud-panel">
        <div class="atlas-header">
            <h2 id="atlas-title" class="cinzel">War Room 1776</h2>
        </div>
        <div class="atlas-info">
            <!-- Current Objective (contextual to location) -->
            <div id="current-objective-row" class="info-row" style="display: none;">
                <span class="info-label">OBJECTIVE</span>
                <span id="current-objective" class="info-value">None</span>
            </div>
            <div class="info-row">
                <span class="info-label">DATE</span>
                <span id="campaign-date" class="info-value">Loading...</span>
            </div>
            <div class="info-row">
                <span class="info-label">TIME</span>
                <span id="campaign-time" class="info-value">Loading...</span>
            </div>
            <div class="info-row">
                <span class="info-label">WEATHER</span>
                <span id="campaign-weather" class="info-value">Loading...</span>
            </div>
        </div>
        <div class="morale-section">
            <label class="morale-label">ARMY MORALE</label>
            <div class="morale-bar">
                <div class="fill" id="morale-fill" style="width: 30%;"></div>
            </div>
        </div>
    </div>

    <!-- Floating HUD: Unit Card (Bottom-Right, contextual) -->
    <div id="floating-unit-card" class="hud-panel" style="display: none;">
        <div class="card-header">
            <h3 id="unit-name">Unit Name</h3>
            <button id="close-unit-card" class="close-btn">✕</button>
        </div>
        <div class="card-stats">
            <div class="stat-row">
                <span class="stat-label">HP</span>
                <span id="unit-hp" class="stat-value">0/0</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">AC</span>
                <span id="unit-ac" class="stat-value">0</span>
            </div>
        </div>
        <div class="card-actions">
            <h4>Actions</h4>
            <div id="unit-actions"></div>
        </div>
    </div>

    <!-- Floating HUD: Combat Tracker (contextual) -->
    <div id="floating-combat-tracker" class="hud-panel" style="display: none;">
        <div class="tracker-header">
            <h3>INITIATIVE</h3>
        </div>
        <div id="initiative-list"></div>
    </div>

    <!-- Floating HUD: Console/Chat (Bottom-Left) -->
    <div id="floating-console" class="hud-panel">
        <div class="console-header">
            <h3>⚔️ WAR ROOM CONSOLE</h3>
        </div>
        <div id="console-messages" class="console-messages">
            <div class="console-message npc-message">
                <span class="message-sender">Gen. Washington:</span>
                <span class="message-text">Greetings soldiers, get warm by the fire. I'll be addressing the camp in a few minutes.</span>
            </div>
        </div>
    </div>

    <!-- External Libraries -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="/socket.io/socket.io.js"></script>

    <!-- Application Scripts (load as ES6 modules) -->
    <script type="module" src="/js/main.js"></script>
</body>
</html>
